terraform scan results:

Passed checks: 5, Failed checks: 7, Skipped checks: 0

Check: CKV_AWS_217: "Ensure Create before destroy for API deployments"
	PASSED for resource: aws_api_gateway_deployment.ok_example
	File: /Prisma_Cloud_TechDocs_CKV2_AWS_4.tf:25-35
Check: CKV_AWS_276: "Ensure Data Trace is not enabled in API Gateway Method Settings"
	PASSED for resource: aws_api_gateway_method_settings.all
	File: /Prisma_Cloud_TechDocs_CKV2_AWS_4.tf:43-52
Check: CKV_AWS_308: "Ensure API Gateway method setting caching is set to encrypted"
	PASSED for resource: aws_api_gateway_method_settings.all
	File: /Prisma_Cloud_TechDocs_CKV2_AWS_4.tf:43-52
Check: CKV2_AWS_77: "Ensure AWS API Gateway Rest API attached WAFv2 WebACL is configured with AMR for Log4j Vulnerability"
	PASSED for resource: aws_api_gateway_stage.ok_example
	File: /Prisma_Cloud_TechDocs_CKV2_AWS_4.tf:37-41
Check: CKV2_AWS_4: "Ensure API Gateway stage have logging level defined as appropriate"
	PASSED for resource: aws_api_gateway_stage.ok_example
	File: /Prisma_Cloud_TechDocs_CKV2_AWS_4.tf:37-41
Check: CKV_AWS_237: "Ensure Create before destroy for API Gateway"
	FAILED for resource: aws_api_gateway_rest_api.ok_example
	File: /Prisma_Cloud_TechDocs_CKV2_AWS_4.tf:1-23

		1  | resource "aws_api_gateway_rest_api" "ok_example" {
		2  |   body = jsonencode({
		3  |     openapi = "3.0.1"
		4  |     info = {
		5  |       title   = "ok_example"
		6  |       version = "1.0"
		7  |     }
		8  |     paths = {
		9  |       "/path1" = {
		10 |         get = {
		11 |           x-amazon-apigateway-integration = {
		12 |             httpMethod           = "GET"
		13 |             payloadFormatVersion = "1.0"
		14 |             type                 = "HTTP_PROXY"
		15 |             uri                  = "https://ip-ranges.amazonaws.com/ip-ranges.json"
		16 |           }
		17 |         }
		18 |       }
		19 |     }
		20 |   })
		21 | 
		22 |   name = "ok_example"
		23 | }

Check: CKV_AWS_120: "Ensure API Gateway caching is enabled"
	FAILED for resource: aws_api_gateway_stage.ok_example
	File: /Prisma_Cloud_TechDocs_CKV2_AWS_4.tf:37-41

		37 | resource "aws_api_gateway_stage" "ok_example" {
		38 |   deployment_id = aws_api_gateway_deployment.ok_example.id
		39 |   rest_api_id   = aws_api_gateway_rest_api.ok_example.id
		40 |   stage_name    = "ok_example"
		41 | }

Check: CKV_AWS_73: "Ensure API Gateway has X-Ray Tracing enabled"
	FAILED for resource: aws_api_gateway_stage.ok_example
	File: /Prisma_Cloud_TechDocs_CKV2_AWS_4.tf:37-41

		37 | resource "aws_api_gateway_stage" "ok_example" {
		38 |   deployment_id = aws_api_gateway_deployment.ok_example.id
		39 |   rest_api_id   = aws_api_gateway_rest_api.ok_example.id
		40 |   stage_name    = "ok_example"
		41 | }

Check: CKV_AWS_76: "Ensure API Gateway has Access Logging enabled"
	FAILED for resource: aws_api_gateway_stage.ok_example
	File: /Prisma_Cloud_TechDocs_CKV2_AWS_4.tf:37-41

		37 | resource "aws_api_gateway_stage" "ok_example" {
		38 |   deployment_id = aws_api_gateway_deployment.ok_example.id
		39 |   rest_api_id   = aws_api_gateway_rest_api.ok_example.id
		40 |   stage_name    = "ok_example"
		41 | }

Check: CKV_AWS_225: "Ensure API Gateway method setting caching is enabled"
	FAILED for resource: aws_api_gateway_method_settings.all
	File: /Prisma_Cloud_TechDocs_CKV2_AWS_4.tf:43-52

		43 | resource "aws_api_gateway_method_settings" "all" {
		44 |   rest_api_id = aws_api_gateway_rest_api.ok_example.id
		45 |   stage_name  = aws_api_gateway_stage.ok_example.stage_name
		46 |   method_path = "*/*"
		47 | 
		48 |   settings {
		49 |     metrics_enabled = true
		50 |     logging_level   = "ERROR"
		51 |   }
		52 | }

Check: CKV2_AWS_51: "Ensure AWS API Gateway endpoints uses client certificate authentication"
	FAILED for resource: aws_api_gateway_stage.ok_example
	File: /Prisma_Cloud_TechDocs_CKV2_AWS_4.tf:37-41

		37 | resource "aws_api_gateway_stage" "ok_example" {
		38 |   deployment_id = aws_api_gateway_deployment.ok_example.id
		39 |   rest_api_id   = aws_api_gateway_rest_api.ok_example.id
		40 |   stage_name    = "ok_example"
		41 | }

Check: CKV2_AWS_29: "Ensure public API gateway are protected by WAF"
	FAILED for resource: aws_api_gateway_stage.ok_example
	File: /Prisma_Cloud_TechDocs_CKV2_AWS_4.tf:37-41

		37 | resource "aws_api_gateway_stage" "ok_example" {
		38 |   deployment_id = aws_api_gateway_deployment.ok_example.id
		39 |   rest_api_id   = aws_api_gateway_rest_api.ok_example.id
		40 |   stage_name    = "ok_example"
		41 | }


(checkov-venv) ameliagasser@MacBook-Pro-2 Test_02_11 % 
